(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var CustomImage = exports.CustomImage = function () {
  function CustomImage(filepath) {
    var _this = this;

    _classCallCheck(this, CustomImage);

    this._image = new Image();
    this._image.onload = function () {
      _this._loaded = true;
    };
    this._image.src = filepath;
  }

  _createClass(CustomImage, [{
    key: "inBoundingBox",
    value: function inBoundingBox(x, y) {
      return x >= this.updatedXpos && x <= this.updatedXpos + this.width && y >= this.updatedYpos && y <= this.updatedYpos + this.height;
    }
  }, {
    key: "xPos",
    set: function set(xPos) {
      this._xpos = xPos;
    },
    get: function get() {
      return this._xpos;
    }
  }, {
    key: "yPos",
    set: function set(yPos) {
      this._ypos = yPos;
    },
    get: function get() {
      return this._ypos;
    }
  }, {
    key: "image",
    get: function get() {
      return this._image;
    }
  }, {
    key: "didload",
    get: function get() {
      return this._loaded;
    }
  }, {
    key: "width",
    get: function get() {
      return this._image.width;
    }
  }, {
    key: "height",
    get: function get() {
      return this._image.height;
    }
  }, {
    key: "updatedXpos",
    get: function get() {
      return this._updatedXpos;
    },
    set: function set(xpos) {
      this._updatedXpos = xpos;
    }
  }, {
    key: "updatedYpos",
    get: function get() {
      return this._updatedYpos;
    },
    set: function set(ypos) {
      this._updatedYpos = ypos;
    }
  }, {
    key: "midpointX",
    get: function get() {
      return this._image.width / 2 + this.xPos;
    }
  }, {
    key: "bottomPart",
    get: function get() {
      return this._image.height + this.yPos;
    }
  }]);

  return CustomImage;
}();

},{}],2:[function(require,module,exports){
'use strict';

var _image = require('./customImage/image.js');

var backgroundCanvas = document.getElementById('background');
var dynamicCanvas = document.getElementById('dynamic');
var dynamicContext = dynamicCanvas.getContext('2d');
var backgroundContext = backgroundCanvas.getContext('2d');

backgroundCanvas.width = window.innerWidth;
backgroundCanvas.height = window.innerHeight;

dynamicCanvas.width = window.innerWidth;
dynamicCanvas.height = window.innerHeight;

var minuteHandDegree = 6;
var hourHandDegree = 0.5;
var degPerHour = 30;

var minuteHandxPos, minuteHandyPos, hourHandxPos, hourHandyPos;
var inleftQuadrant = false;
var inrightQuadrant = false;

var mousePositionX = 0;
var mousePositionY = 0;
var hourHandAngle = 0;
var angle = 0;
var movingAngle = 0;
var minutes = 0;
var hours = 12;

var reqFrame;
var hourcount = 0;

var boundingRect = dynamicCanvas.getBoundingClientRect();

var images = {
  background: new _image.CustomImage("./assets/static/background.jpg"),
  wristWatch: new _image.CustomImage("./assets/static/clockresized.png"),
  minuteHand: new _image.CustomImage("./assets/dynamic/hands/minutehandresized.png"),
  hourHand: new _image.CustomImage("./assets/dynamic/hands/hourhandresized.png"),
  digitalWatch: new _image.CustomImage("./assets/static/digital_times_resized.png")
};

var imageloadObserver;

//Check that all images have loaded
function checkIfloaded() {
  var imagesLoaded = 0;
  var numImages = 0;

  for (var image in images) {
    numImages++;
  }

  for (var image in images) {
    if (images[image].didload) {

      imagesLoaded++;
    }
  }
  if (imagesLoaded >= numImages) {

    clearInterval(imageloadObserver);
    setParameters();
  }
}

//Sets all the parameters. The background is static and starts from the origin.
// The analogue clock is placed 1/4 of the screen from the left. All the other objects are relative to the 
//analogue clock.
function setParameters() {

  images.background.xPos = 0;
  images.background.yPos = 0;
  images.wristWatch.xPos = backgroundCanvas.width / 4 - images.wristWatch.width;
  images.wristWatch.yPos = backgroundCanvas.height / 4;
  images.minuteHand.xPos = images.wristWatch.midpointX - images.minuteHand.width / 2;
  images.minuteHand.yPos = dynamicCanvas.height / 4 + images.wristWatch.height / 2 - images.minuteHand.height;
  images.hourHand.xPos = images.wristWatch.xPos + images.wristWatch.width / 2 - images.hourHand.width / 2;
  images.hourHand.yPos = images.wristWatch.yPos + images.wristWatch.height / 2 - images.hourHand.height;
  images.digitalWatch.xPos = backgroundCanvas.width * 3 / 4 - images.digitalWatch.width;
  images.digitalWatch.yPos = images.wristWatch.height / 2 + backgroundCanvas.height / 4 - images.digitalWatch.height / 2;
  images.minuteHand.updatedXpos = images.minuteHand.xPos;
  images.minuteHand.updatedYpos = images.minuteHand.yPos;
  hourHandxPos = images.digitalWatch.xPos + images.digitalWatch.width / 8;
  hourHandyPos = images.digitalWatch.yPos + images.digitalWatch.height / 2;
  images.hourHand.updatedXpos = images.hourHand.xPos;
  images.hourHand.updatedYpos = images.hourHand.yPos;
  minuteHandxPos = hourHandxPos + images.digitalWatch.width * 3 / 8;
  minuteHandyPos = hourHandyPos;
  draw();
  setListeners();
}

//Draw the images at the set positions
function draw() {
  backgroundContext.drawImage(images.background.image, images.background.xPos, images.background.yPos);
  backgroundContext.drawImage(images.wristWatch.image, images.wristWatch.xPos, images.wristWatch.yPos);
  // backgroundContext.drawImage(images.clockBtn.image, images.clockBtn.xPos, images.clockBtn.yPos);
  backgroundContext.drawImage(images.digitalWatch.image, images.digitalWatch.xPos, images.digitalWatch.yPos);
  // backgroundContext.drawImage(images.upArrow.image, images.upArrow.xPos, images.upArrow.yPos);
  // backgroundContext.drawImage(images.downArrow.image, images.downArrow.xPos, images.downArrow.yPos);
  dynamicContext.drawImage(images.minuteHand.image, images.minuteHand.xPos, images.minuteHand.yPos);
  dynamicContext.drawImage(images.hourHand.image, images.minuteHand.xPos, images.hourHand.yPos);
  dynamicContext.font = '50pt verdana, sans-serif';
  dynamicContext.fillStyle = "#FFFFFF";
  backgroundContext.font = dynamicContext.font;
  backgroundContext.fillStyle = dynamicContext.fillStyle;
  dynamicContext.fillText("12", hourHandxPos, hourHandyPos);
  backgroundContext.fillText(":", hourHandxPos + 2 * images.digitalWatch.width / 8, hourHandyPos - 5);
  dynamicContext.fillText("00", minuteHandxPos, minuteHandyPos);
}

function setListeners() {
  /*
    * When mouse is pressed. Check if the mouse is in the bounding box of either the hourhand or the minutehand
    * and call the respective function.
    */
  dynamicCanvas.addEventListener("mousedown", function () {

    if (images.hourHand.inBoundingBox(event.clientX, event.clientY)) {
      dynamicCanvas.onmousemove = function () {
        mousePositionX = event.clientX;
        mousePositionY = event.clientY;

        reqFrame = window.requestAnimationFrame(hourhand);
      };
    } else if (images.minuteHand.inBoundingBox(event.clientX, event.clientY)) {
      dynamicCanvas.onmousemove = function () {
        mousePositionX = event.clientX;
        mousePositionY = event.clientY;

        reqFrame = window.requestAnimationFrame(minuteHand);
      };
    }
  });

  //Stop the animation of the minute or hour hand.
  dynamicCanvas.addEventListener("mouseup", function () {
    window.cancelAnimationFrame(reqFrame);
    dynamicCanvas.onmousemove = null;
  });
}

//Makes the minutehand point to the cursor 
function minuteHand() {
  var dx = mousePositionX - (images.minuteHand.xPos + images.minuteHand.width / 2);
  var dy = mousePositionY - (images.minuteHand.yPos + images.minuteHand.height);
  angle = Math.atan2(dy, dx) + 1.5708;
  var degrees = Math.floor(angle * 57.2958);
  degrees = degrees < 0 ? 360 + degrees : degrees;

  /**
   * Draw a vertical and horizontal line on the clock. If the minute hand is in the bottom 2 quadrants
   * then ignore it. If the minute hand is in the top left quadrant then in the right quadrant then add 1 to
   * the hours other wise subtract one.
   */

  if (degrees <= 90 || degrees >= 270) {
    if (degrees >= 270 && degrees < 360) {
      inleftQuadrant = true;
      if (inrightQuadrant) {
        hourcount--;
        inrightQuadrant = false;
        minutes = 59;
      }
    }

    if (degrees >= 0 && degrees <= 90) {
      inrightQuadrant = true;
      if (inleftQuadrant) {

        hourcount++;
        inleftQuadrant = false;
      }
    }
  } else {
    inrightQuadrant = false;
    inleftQuadrant = false;
  }
  hours = hourcount;

  hourHandAngle = (hourcount * degPerHour + Math.floor(degrees / minuteHandDegree * hourHandDegree)) * (Math.PI / 180);
  minutes = Math.floor(degrees / 6);
  correctHour();
  dynamicContext.clearRect(0, 0, dynamicCanvas.width, dynamicCanvas.height);
  rotateImage(angle, images.minuteHand.xPos + images.minuteHand.width / 2, images.minuteHand.yPos + images.minuteHand.height, images.minuteHand);
  rotateImage(hourHandAngle, images.hourHand.xPos + images.hourHand.width / 2, images.hourHand.yPos + images.hourHand.height, images.hourHand);
  dynamicContext.fillText(padInput(hours), hourHandxPos, hourHandyPos);
  dynamicContext.fillText(padInput(minutes), minuteHandxPos, minuteHandyPos);
}

//Makes the hour hand point to the cursor
function hourhand() {
  var dx = mousePositionX - (images.hourHand.xPos + images.hourHand.width / 2);
  var dy = mousePositionY - (images.hourHand.yPos + images.hourHand.height);

  angle = Math.atan2(dy, dx) + 1.5708;
  var degrees = Math.round(angle * 57.2958 * 10) / 10;
  degrees = degrees < 0 ? 360 + degrees : degrees;
  var minutehandmovement = degrees / 0.5 * 6 * (Math.PI / 180);

  minutes = Math.floor(degrees / 0.5 % 60);
  hours = Math.floor(degrees / 30);
  correctHour();

  dynamicContext.clearRect(0, 0, dynamicCanvas.width, dynamicCanvas.height);
  rotateImage(minutehandmovement, images.minuteHand.xPos + images.minuteHand.width / 2, images.minuteHand.yPos + images.minuteHand.height, images.minuteHand);
  rotateImage(angle, images.hourHand.xPos + images.hourHand.width / 2, images.hourHand.yPos + images.hourHand.height, images.hourHand);
  dynamicContext.fillText(padInput(hours), hourHandxPos, hourHandyPos);
  dynamicContext.fillText(padInput(minutes), minuteHandxPos, minuteHandyPos);
}

//Reset the hours such that it is always between 1 and 12 inclusive
function correctHour() {
  hours = hours % 12;
  if (hours == 0) {
    hours = 12;
  }
  if (hours < 0) {
    hours += 12;
  }
}

//Add a 0 in front if the number has only one digit
function padInput(number) {
  return number < 10 ? "0" + number : number.toString();
}

//Perform the rotation of the canvas and draws the image on the rotated angle.
function rotateImage(angle, translateXpos, translateYpos, imageObj) {
  dynamicContext.save();
  dynamicContext.translate(translateXpos, translateYpos);
  dynamicContext.rotate(angle);
  dynamicContext.translate(-translateXpos, -translateYpos);
  dynamicContext.drawImage(imageObj.image, imageObj.xPos, imageObj.yPos);
  dynamicContext.restore();
}

imageloadObserver = window.setInterval(checkIfloaded, 400);

},{"./customImage/image.js":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAvanMvY3VzdG9tSW1hZ2UvaW1hZ2UuanMiLCJhcHAvanMvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7O0lDQWEsVyxXQUFBLFc7QUFFWCx1QkFBWSxRQUFaLEVBQ0E7QUFBQTs7QUFBQTs7QUFDRSxTQUFLLE1BQUwsR0FBYyxJQUFJLEtBQUosRUFBZDtBQUNBLFNBQUssTUFBTCxDQUFZLE1BQVosR0FBcUIsWUFDckI7QUFDRSxZQUFLLE9BQUwsR0FBZSxJQUFmO0FBQ0QsS0FIRDtBQUlBLFNBQUssTUFBTCxDQUFZLEdBQVosR0FBa0IsUUFBbEI7QUFDRDs7OztrQ0F3RWEsQyxFQUFFLEMsRUFDakI7QUFDRSxhQUFTLEtBQUssS0FBSyxXQUFWLElBQXlCLEtBQUssS0FBSyxXQUFMLEdBQWtCLEtBQUssS0FBdEQsSUFBaUUsS0FBSyxLQUFLLFdBQVYsSUFBeUIsS0FBSyxLQUFLLFdBQUwsR0FBbUIsS0FBSyxNQUEvSDtBQUNEOzs7c0JBekVTLEksRUFDVjtBQUNFLFdBQUssS0FBTCxHQUFhLElBQWI7QUFDRCxLO3dCQVFEO0FBQ0UsYUFBTyxLQUFLLEtBQVo7QUFDRDs7O3NCQVJTLEksRUFDVjtBQUNFLFdBQUssS0FBTCxHQUFhLElBQWI7QUFDRCxLO3dCQU9EO0FBQ0UsYUFBTyxLQUFLLEtBQVo7QUFDRDs7O3dCQUdEO0FBQ0UsYUFBTyxLQUFLLE1BQVo7QUFDRDs7O3dCQUdEO0FBQ0UsYUFBTyxLQUFLLE9BQVo7QUFDRDs7O3dCQUdEO0FBQ0UsYUFBTyxLQUFLLE1BQUwsQ0FBWSxLQUFuQjtBQUNEOzs7d0JBR0Q7QUFDRSxhQUFPLEtBQUssTUFBTCxDQUFZLE1BQW5CO0FBQ0Q7Ozt3QkFHRDtBQUNFLGFBQU8sS0FBSyxZQUFaO0FBQ0QsSztzQkFPZSxJLEVBQ2hCO0FBQ0UsV0FBSyxZQUFMLEdBQW9CLElBQXBCO0FBQ0Q7Ozt3QkFQRDtB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QTJDLENBQUcsYUFBOUM7QUFDQSxpQkFBZSxTQUFmLENBQXlCLFNBQVMsS0FBbEMsRUFBeUMsU0FBUyxJQUFsRCxFQUF3RCxTQUFTLElBQWpFO0FBQ0EsaUJBQWUsT0FBZjtBQUVEOztBQUVELG9CQUFvQixPQUFPLFdBQVAsQ0FBbUIsYUFBbkIsRUFBa0MsR0FBbEMsQ0FBcEIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiZXhwb3J0IGNsYXNzIEN1c3RvbUltYWdle1xuXG4gIGNvbnN0cnVjdG9yKGZpbGVwYXRoKVxuICB7XG4gICAgdGhpcy5faW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgICB0aGlzLl9pbWFnZS5vbmxvYWQgPSAoKSA9PlxuICAgIHtcbiAgICAgIHRoaXMuX2xvYWRlZCA9IHRydWU7XG4gICAgfTtcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBmaWxlcGF0aDtcbiAgfVxuXG4gIHNldCB4UG9zKHhQb3MpXG4ge1xuICAgdGhpcy5feHBvcyA9IHhQb3M7XG4gfVxuXG4gIHNldCB5UG9zKHlQb3MpXG4ge1xuICAgdGhpcy5feXBvcyA9IHlQb3M7XG4gfVxuXG4gIGdldCB4UG9zKClcbiB7XG4gICByZXR1cm4gdGhpcy5feHBvcztcbiB9XG4gIGdldCB5UG9zKClcbiB7XG4gICByZXR1cm4gdGhpcy5feXBvcztcbiB9XG5cbiBnZXQgaW1hZ2UoKVxuIHtcbiAgIHJldHVybiB0aGlzLl9pbWFnZTtcbiB9XG5cbiBnZXQgZGlkbG9hZCgpXG4ge1xuICAgcmV0dXJuIHRoaXMuX2xvYWRlZDtcbiB9XG5cbiBnZXQgd2lkdGgoKVxuIHtcbiAgIHJldHVybiB0aGlzLl9pbWFnZS53aWR0aDtcbiB9XG5cbiBnZXQgaGVpZ2h0KClcbiB7XG4gICByZXR1cm4gdGhpcy5faW1hZ2UuaGVpZ2h0O1xuIH1cblxuIGdldCB1cGRhdGVkWHBvcygpXG4ge1xuICAgcmV0dXJuIHRoaXMuX3VwZGF0ZWRYcG9zO1xuIH1cblxuIGdldCB1cGRhdGVkWXBvcygpXG4ge1xuICAgcmV0dXJuIHRoaXMuX3VwZGF0ZWRZcG9zO1xuIH1cblxuIHNldCB1cGRhdGVkWHBvcyh4cG9zKVxuIHtcbiAgIHRoaXMuX3VwZGF0ZWRYcG9zID0geHBvcztcbiB9XG5cbiBzZXQgdXBkYXRlZFlwb3MoeXBvcylcbiB7XG4gICB0aGlzLl91cGRhdGVkWXBvcyA9IHlwb3M7XG4gfVxuXG5cbiBnZXQgbWlkcG9pbnRYKClcbiB7XG4gICByZXR1cm4gdGhpcy5faW1hZ2Uud2lkdGgvMiArIHRoaXMueFBvcztcbiB9XG5cbiBnZXQgYm90dG9tUGFydCgpXG4ge1xuICAgcmV0dXJuIHRoaXMuX2ltYWdlLmhlaWdodCArIHRoaXMueVBvcztcbiB9XG5cbiAgaW5Cb3VuZGluZ0JveCh4LHkpXG4ge1xuICAgcmV0dXJuICgoeCA+PSB0aGlzLnVwZGF0ZWRYcG9zICYmIHggPD0gdGhpcy51cGRhdGVkWHBvcysgdGhpcy53aWR0aCkgJiYgKHkgPj0gdGhpcy51cGRhdGVkWXBvcyAmJiB5IDw9IHRoaXMudXBkYXRlZFlwb3MgKyB0aGlzLmhlaWdodCkpO1xuIH1cbn1cbiIsImltcG9ydCB7Q3VzdG9tSW1hZ2V9IGZyb20gXCIuL2N1c3RvbUltYWdlL2ltYWdlLmpzXCJcblxuY29uc3QgYmFja2dyb3VuZENhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYWNrZ3JvdW5kJyk7XG5jb25zdCBkeW5hbWljQ2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R5bmFtaWMnKTtcbmNvbnN0IGR5bmFtaWNDb250ZXh0ID0gZHluYW1pY0NhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuY29uc3QgYmFja2dyb3VuZENvbnRleHQgPSBiYWNrZ3JvdW5kQ2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cblxuYmFja2dyb3VuZENhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuYmFja2dyb3VuZENhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cbmR5bmFtaWNDYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbmR5bmFtaWNDYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuXG5jb25zdCBtaW51dGVIYW5kRGVncmVlID0gNjtcbmNvbnN0IGhvdXJIYW5kRGVncmVlID0gMC41O1xuY29uc3QgZGVnUGVySG91ciA9IDMwO1xuXG52YXIgbWludXRlSGFuZHhQb3MsbWludXRlSGFuZHlQb3MsaG91ckhhbmR4UG9zLGhvdXJIYW5keVBvcztcbnZhciBpbmxlZnRRdWFkcmFudCA9IGZhbHNlO1xudmFyIGlucmlnaHRRdWFkcmFudCA9IGZhbHNlO1xuXG52YXIgbW91c2VQb3NpdGlvblggPSAwO1xudmFyIG1vdXNlUG9zaXRpb25ZID0gMDtcbnZhciBob3VySGFuZEFuZ2xlID0gMDtcbnZhciBhbmdsZSA9IDA7XG52YXIgbW92aW5nQW5nbGUgPSAwO1xudmFyIG1pbnV0ZXMgPSAwO1xudmFyIGhvdXJzID0gMTI7XG5cbnZhciByZXFGcmFtZTtcbnZhciBob3VyY291bnQgPSAwO1xuXG52YXIgYm91bmRpbmdSZWN0ID0gZHluYW1pY0NhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuY29uc3QgaW1hZ2VzID0ge1xuICBiYWNrZ3JvdW5kOiBuZXcgQ3VzdG9tSW1hZ2UoXCIuL2Fzc2V0cy9zdGF0aWMvYmFja2dyb3VuZC5qcGdcIiksXG4gIHdyaXN0V2F0Y2g6IG5ldyBDdXN0b21JbWFnZShcIi4vYXNzZXRzL3N0YXRpYy9jbG9ja3Jlc2l6ZWQucG5nXCIpLFxuICBtaW51dGVIYW5kOiBuZXcgQ3VzdG9tSW1hZ2UoXCIuL2Fzc2V0cy9keW5hbWljL2hhbmRzL21pbnV0ZWhhbmRyZXNpemVkLnBuZ1wiKSxcbiAgaG91ckhhbmQ6IG5ldyBDdXN0b21JbWFnZShcIi4vYXNzZXRzL2R5bmFtaWMvaGFuZHMvaG91cmhhbmRyZXNpemVkLnBuZ1wiKSxcbiAgZGlnaXRhbFdhdGNoOiBuZXcgQ3VzdG9tSW1hZ2UoXCIuL2Fzc2V0cy9zdGF0aWMvZGlnaXRhbF90aW1lc19yZXNpemVkLnBuZ1wiKVxufTtcblxudmFyIGltYWdlbG9hZE9ic2VydmVyO1xuXG4vL0NoZWNrIHRoYXQgYWxsIGltYWdlcyBoYXZlIGxvYWRlZFxuZnVuY3Rpb24gY2hlY2tJZmxvYWRlZCgpIHtcbiAgbGV0IGltYWdlc0xvYWRlZCA9IDA7XG4gIGxldCBudW1JbWFnZXMgPSAwO1xuXG4gIGZvciAodmFyIGltYWdlIGluIGltYWdlcykge1xuICAgIG51bUltYWdlcysrO1xuICB9XG5cbiAgZm9yICh2YXIgaW1hZ2UgaW4gaW1hZ2VzKSB7XG4gICAgaWYgKGltYWdlc1tpbWFnZV0uZGlkbG9hZCkge1xuXG4gICAgICBpbWFnZXNMb2FkZWQrKztcbiAgICB9XG4gIH1cbiAgaWYgKGltYWdlc0xvYWRlZCA+PSBudW1JbWFnZXMpIHtcblxuICAgIGNsZWFySW50ZXJ2YWwoaW1hZ2Vsb2FkT2JzZXJ2ZXIpO1xuICAgIHNldFBhcmFtZXRlcnMoKTtcblxuICB9XG59XG5cbi8vU2V0cyBhbGwgdGhlIHBhcmFtZXRlcnMuIFRoZSBiYWNrZ3JvdW5kIGlzIHN0YXRpYyBhbmQgc3RhcnRzIGZyb20gdGhlIG9yaWdpbi5cbi8vIFRoZSBhbmFsb2d1ZSBjbG9jayBpcyBwbGFjZWQgMS80IG9mIHRoZSBzY3JlZW4gZnJvbSB0aGUgbGVmdC4gQWxsIHRoZSBvdGhlciBvYmplY3RzIGFyZSByZWxhdGl2ZSB0byB0aGUgXG4vL2FuYWxvZ3VlIGNsb2NrLlxuZnVuY3Rpb24gc2V0UGFyYW1ldGVycygpIHtcblxuICBpbWFnZXMuYmFja2dyb3VuZC54UG9zID0gMDtcbiAgaW1hZ2VzLmJhY2tncm91bmQueVBvcyA9IDA7XG4gIGltYWdlcy53cmlzdFdhdGNoLnhQb3MgPSBiYWNrZ3JvdW5kQ2FudmFzLndpZHRoIC8gNCAtIGltYWdlcy53cmlzdFdhdGNoLndpZHRoO1xuICBpbWFnZXMud3Jpc3RXYXRjaC55UG9zID0gYmFja2dyb3VuZENhbnZhcy5oZWlnaHQgLyA0O1xuICBpbWFnZXMubWludXRlSGFuZC54UG9zID0gaW1hZ2VzLndyaXN0V2F0Y2gubWlkcG9pbnRYIC0gaW1hZ2VzLm1pbnV0ZUhhbmQud2lkdGggLyAyO1xuICBpbWFnZXMubWludXRlSGFuZC55UG9zID0gKGR5bmFtaWNDYW52YXMuaGVpZ2h0IC8gNCkgKyAoaW1hZ2VzLndyaXN0V2F0Y2guaGVpZ2h0IC8gMikgLSBpbWFnZXMubWludXRlSGFuZC5oZWlnaHQ7XG4gIGltYWdlcy5ob3VySGFuZC54UG9zID0gaW1hZ2VzLndyaXN0V2F0Y2gueFBvcyArIGltYWdlcy53cmlzdFdhdGNoLndpZHRoIC8gMiAtIGltYWdlcy5ob3VySGFuZC53aWR0aCAvIDI7XG4gIGltYWdlcy5ob3VySGFuZC55UG9zID0gKGltYWdlcy53cmlzdFdhdGNoLnlQb3MgKyBpbWFnZXMud3Jpc3RXYXRjaC5oZWlnaHQgLyAyKSAtIGltYWdlcy5ob3VySGFuZC5oZWlnaHQ7XG4gIGltYWdlcy5kaWdpdGFsV2F0Y2gueFBvcyA9IChiYWNrZ3JvdW5kQ2FudmFzLndpZHRoICogMykgLyA0IC0gaW1hZ2VzLmRpZ2l0YWxXYXRjaC53aWR0aDtcbiAgaW1hZ2VzLmRpZ2l0YWxXYXRjaC55UG9zID0gKGltYWdlcy53cmlzdFdhdGNoLmhlaWdodCAvIDIgKyBiYWNrZ3JvdW5kQ2FudmFzLmhlaWdodCAvIDQpIC0gKGltYWdlcy5kaWdpdGFsV2F0Y2guaGVpZ2h0IC8gMik7XG4gIGltYWdlcy5taW51dGVIYW5kLnVwZGF0ZWRYcG9zID0gaW1hZ2VzLm1pbnV0ZUhhbmQueFBvcztcbiAgaW1hZ2VzLm1pbnV0ZUhhbmQudXBkYXRlZFlwb3MgPSBpbWFnZXMubWludXRlSGFuZC55UG9zO1xuICBob3VySGFuZHhQb3MgPSBpbWFnZXMuZGlnaXRhbFdhdGNoLnhQb3MgKyAoaW1hZ2VzLmRpZ2l0YWxXYXRjaC53aWR0aCkgLyA4O1xuICBob3VySGFuZHlQb3MgPSBpbWFnZXMuZGlnaXRhbFdhdGNoLnlQb3MgKyBpbWFnZXMuZGlnaXRhbFdhdGNoLmhlaWdodCAvIDI7XG4gIGltYWdlcy5ob3VySGFuZC51cGRhdGVkWHBvcyA9IGltYWdlcy5ob3VySGFuZC54UG9zO1xuICBpbWFnZXMuaG91ckhhbmQudXBkYXRlZFlwb3MgPSBpbWFnZXMuaG91ckhhbmQueVBvcztcbiAgbWludXRlSGFuZHhQb3MgPSBob3VySGFuZHhQb3MgKyAoaW1hZ2VzLmRpZ2l0YWxXYXRjaC53aWR0aCAqIDMpIC8gODtcbiAgbWludXRlSGFuZHlQb3MgPSBob3VySGFuZHlQb3M7XG4gIGRyYXcoKTtcbiAgc2V0TGlzdGVuZXJzKCk7XG5cbn1cblxuLy9EcmF3IHRoZSBpbWFnZXMgYXQgdGhlIHNldCBwb3NpdGlvbnNcbmZ1bmN0aW9uIGRyYXcoKVxue1xuICBiYWNrZ3JvdW5kQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VzLmJhY2tncm91bmQuaW1hZ2UsIGltYWdlcy5iYWNrZ3JvdW5kLnhQb3MsIGltYWdlcy5iYWNrZ3JvdW5kLnlQb3MpO1xuICBiYWNrZ3JvdW5kQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VzLndyaXN0V2F0Y2guaW1hZ2UsIGltYWdlcy53cmlzdFdhdGNoLnhQb3MsIGltYWdlcy53cmlzdFdhdGNoLnlQb3MpO1xuICAvLyBiYWNrZ3JvdW5kQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VzLmNsb2NrQnRuLmltYWdlLCBpbWFnZXMuY2xvY2tCdG4ueFBvcywgaW1hZ2VzLmNsb2NrQnRuLnlQb3MpO1xuICBiYWNrZ3JvdW5kQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VzLmRpZ2l0YWxXYXRjaC5pbWFnZSwgaW1hZ2VzLmRpZ2l0YWxXYXRjaC54UG9zLCBpbWFnZXMuZGlnaXRhbFdhdGNoLnlQb3MpO1xuICAvLyBiYWNrZ3JvdW5kQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VzLnVwQXJyb3cuaW1hZ2UsIGltYWdlcy51cEFycm93LnhQb3MsIGltYWdlcy51cEFycm93LnlQb3MpO1xuICAvLyBiYWNrZ3JvdW5kQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VzLmRvd25BcnJvdy5pbWFnZSwgaW1hZ2VzLmRvd25BcnJvdy54UG9zLCBpbWFnZXMuZG93bkFycm93LnlQb3MpO1xuICBkeW5hbWljQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VzLm1pbnV0ZUhhbmQuaW1hZ2UsIGltYWdlcy5taW51dGVIYW5kLnhQb3MsIGltYWdlcy5taW51dGVIYW5kLnlQb3MpO1xuICBkeW5hbWljQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VzLmhvdXJIYW5kLmltYWdlLCBpbWFnZXMubWludXRlSGFuZC54UG9zLCBpbWFnZXMuaG91ckhhbmQueVBvcyk7XG4gIGR5bmFtaWNDb250ZXh0LmZvbnQgPSAnNTBwdCB2ZXJkYW5hLCBzYW5zLXNlcmlmJztcbiAgZHluYW1pY0NvbnRleHQuZmlsbFN0eWxlID0gXCIjRkZGRkZGXCI7XG4gIGJhY2tncm91bmRDb250ZXh0LmZvbnQgPSBkeW5hbWljQ29udGV4dC5mb250O1xuICBiYWNrZ3JvdW5kQ29udGV4dC5maWxsU3R5bGUgPSBkeW5hbWljQ29udGV4dC5maWxsU3R5bGU7XG4gIGR5bmFtaWNDb250ZXh0LmZpbGxUZXh0KFwiMTJcIiwgaG91ckhhbmR4UG9zLCBob3VySGFuZHlQb3MpO1xuICBiYWNrZ3JvdW5kQ29udGV4dC5maWxsVGV4dChcIjpcIiwgaG91ckhhbmR4UG9zICsgKDIgKiBpbWFnZXMuZGlnaXRhbFdhdGNoLndpZHRoKSAvIDgsIGhvdXJIYW5keVBvcyAtIDUpO1xuICBkeW5hbWljQ29udGV4dC5maWxsVGV4dChcIjAwXCIsIG1pbnV0ZUhhbmR4UG9zLCBtaW51dGVIYW5keVBvcyk7XG59XG5cbmZ1bmN0aW9uIHNldExpc3RlbmVycygpIHtcbiAgLypcbiAgICAqIFdoZW4gbW91c2UgaXMgcHJlc3NlZC4gQ2hlY2sgaWYgdGhlIG1vdXNlIGlzIGluIHRoZSBib3VuZGluZyBib3ggb2YgZWl0aGVyIHRoZSBob3VyaGFuZCBvciB0aGUgbWludXRlaGFuZFxuICAgICogYW5kIGNhbGwgdGhlIHJlc3BlY3RpdmUgZnVuY3Rpb24uXG4gICAgKi9cbiAgZHluYW1pY0NhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcblxuICAgIGlmKGltYWdlcy5ob3VySGFuZC5pbkJvdW5kaW5nQm94KGV2ZW50LmNsaWVudFgsZXZlbnQuY2xpZW50WSkpXG4gICAge1xuICAgICAgZHluYW1pY0NhbnZhcy5vbm1vdXNlbW92ZSA9ICgpID0+XG4gICAgICB7XG4gICAgICAgIG1vdXNlUG9zaXRpb25YID0gZXZlbnQuY2xpZW50WDtcbiAgICAgICAgbW91c2VQb3NpdGlvblkgPSBldmVudC5jbGllbnRZO1xuXG4gICAgICAgIHJlcUZyYW1lID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShob3VyaGFuZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZWxzZSBpZihpbWFnZXMubWludXRlSGFuZC5pbkJvdW5kaW5nQm94KGV2ZW50LmNsaWVudFgsZXZlbnQuY2xpZW50WSkpXG4gICAge1xuICAgICAgIGR5bmFtaWNDYW52YXMub25tb3VzZW1vdmUgPSAoKSA9PlxuICAgICAge1xuICAgICAgICBtb3VzZVBvc2l0aW9uWCA9IGV2ZW50LmNsaWVudFg7XG4gICAgICAgIG1vdXNlUG9zaXRpb25ZID0gZXZlbnQuY2xpZW50WTtcblxuICAgICAgICByZXFGcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobWludXRlSGFuZCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvL1N0b3AgdGhlIGFuaW1hdGlvbiBvZiB0aGUgbWludXRlIG9yIGhvdXIgaGFuZC5cbiAgICBkeW5hbWljQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsICgpID0+IHtcbiAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZShyZXFGcmFtZSk7XG4gICAgICBkeW5hbWljQ2FudmFzLm9ubW91c2Vtb3ZlID0gbnVsbDtcblxuICB9KTtcblxufVxuXG5cbi8vTWFrZXMgdGhlIG1pbnV0ZWhhbmQgcG9pbnQgdG8gdGhlIGN1cnNvciBcbmZ1bmN0aW9uIG1pbnV0ZUhhbmQoKSB7XG4gIHZhciBkeCA9IG1vdXNlUG9zaXRpb25YIC0gKGltYWdlcy5taW51dGVIYW5kLnhQb3MgKyBpbWFnZXMubWludXRlSGFuZC53aWR0aCAvIDIpO1xuICB2YXIgZHkgPSBtb3VzZVBvc2l0aW9uWSAtIChpbWFnZXMubWludXRlSGFuZC55UG9zICsgaW1hZ2VzLm1pbnV0ZUhhbmQuaGVpZ2h0KTtcbiAgYW5nbGUgPSBNYXRoLmF0YW4yKGR5LCBkeCkgKyAxLjU3MDg7XG4gIHZhciBkZWdyZWVzID0gTWF0aC5mbG9vcihhbmdsZSAqIDU3LjI5NTgpO1xuICBkZWdyZWVzID0gKGRlZ3JlZXMgPCAwKSA/IDM2MCArIGRlZ3JlZXMgOiBkZWdyZWVzO1xuXG4vKipcbiAqIERyYXcgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBsaW5lIG9uIHRoZSBjbG9jay4gSWYgdGhlIG1pbnV0ZSBoYW5kIGlzIGluIHRoZSBib3R0b20gMiBxdWFkcmFudHNcbiAqIHRoZW4gaWdub3JlIGl0LiBJZiB0aGUgbWludXRlIGhhbmQgaXMgaW4gdGhlIHRvcCBsZWZ0IHF1YWRyYW50IHRoZW4gaW4gdGhlIHJpZ2h0IHF1YWRyYW50IHRoZW4gYWRkIDEgdG9cbiAqIHRoZSBob3VycyBvdGhlciB3aXNlIHN1YnRyYWN0IG9uZS5cbiAqL1xuXG5cbiAgaWYgKGRlZ3JlZXMgPD0gOTAgfHwgZGVncmVlcyA+PSAyNzApIHtcbiAgICBpZiAoZGVncmVlcyA+PSAyNzAgJiYgZGVncmVlcyA8IDM2MCkge1xuICAgICAgaW5sZWZ0UXVhZHJhbnQgPSB0cnVlO1xuICAgICAgaWYgKGlucmlnaHRRdWFkcmFudCkge1xuICAgICAgICBob3VyY291bnQtLTtcbiAgICAgICAgaW5yaWdodFF1YWRyYW50ID0gZmFsc2U7XG4gICAgICAgIG1pbnV0ZXMgPSA1OTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZGVncmVlcyA+PSAwICYmIGRlZ3JlZXMgPD0gOTApIHtcbiAgICAgIGlucmlnaHRRdWFkcmFudCA9IHRydWU7XG4gICAgICBpZiAoaW5sZWZ0UXVhZHJhbnQpIHtcblxuICAgICAgICBob3VyY291bnQrKztcbiAgICAgICAgaW5sZWZ0UXVhZHJhbnQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZWxzZSB7XG4gICAgaW5yaWdodFF1YWRyYW50ID0gZmFsc2U7XG4gICAgaW5sZWZ0UXVhZHJhbnQgPSBmYWxzZTtcbiAgfVxuICBob3VycyA9IGhvdXJjb3VudDtcblxuXG4gIGhvdXJIYW5kQW5nbGUgPSAoKGhvdXJjb3VudCAqIGRlZ1BlckhvdXIpICsgTWF0aC5mbG9vcigoZGVncmVlcyAvIG1pbnV0ZUhhbmREZWdyZWUpICogaG91ckhhbmREZWdyZWUpKSAqIChNYXRoLlBJIC8gMTgwKTtcbiAgbWludXRlcyA9IE1hdGguZmxvb3IoZGVncmVlcy82KTtcbiAgY29ycmVjdEhvdXIoKTtcbiAgZHluYW1pY0NvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGR5bmFtaWNDYW52YXMud2lkdGgsIGR5bmFtaWNDYW52YXMuaGVpZ2h0KTtcbiAgcm90YXRlSW1hZ2UoYW5nbGUsIGltYWdlcy5taW51dGVIYW5kLnhQb3MgKyBpbWFnZXMubWludXRlSGFuZC53aWR0aCAvIDIsIGltYWdlcy5taW51dGVIYW5kLnlQb3MgKyBpbWFnZXMubWludXRlSGFuZC5oZWlnaHQsIGltYWdlcy5taW51dGVIYW5kKTtcbiAgcm90YXRlSW1hZ2UoaG91ckhhbmRBbmdsZSwgaW1hZ2VzLmhvdXJIYW5kLnhQb3MgKyBpbWFnZXMuaG91ckhhbmQud2lkdGggLyAyLCBpbWFnZXMuaG91ckhhbmQueVBvcyArIGltYWdlcy5ob3VySGFuZC5oZWlnaHQsIGltYWdlcy5ob3VySGFuZCk7XG4gIGR5bmFtaWNDb250ZXh0LmZpbGxUZXh0KHBhZElucHV0KGhvdXJzKSwgaG91ckhhbmR4UG9zLCBob3VySGFuZHlQb3MpO1xuICBkeW5hbWljQ29udGV4dC5maWxsVGV4dChwYWRJbnB1dChtaW51dGVzKSwgbWludXRlSGFuZHhQb3MsIG1pbnV0ZUhhbmR5UG9zKTtcbn1cblxuLy9NYWtlcyB0aGUgaG91ciBoYW5kIHBvaW50IHRvIHRoZSBjdXJzb3JcbmZ1bmN0aW9uIGhvdXJoYW5kKCkge1xuICB2YXIgZHggPSBtb3VzZVBvc2l0aW9uWCAtIChpbWFnZXMuaG91ckhhbmQueFBvcyArIGltYWdlcy5ob3VySGFuZC53aWR0aCAvIDIpO1xuICB2YXIgZHkgPSBtb3VzZVBvc2l0aW9uWSAtIChpbWFnZXMuaG91ckhhbmQueVBvcyArIGltYWdlcy5ob3VySGFuZC5oZWlnaHQpO1xuXG4gIGFuZ2xlID0gTWF0aC5hdGFuMihkeSwgZHgpICsgMS41NzA4O1xuICB2YXIgZGVncmVlcyA9IE1hdGgucm91bmQoKGFuZ2xlICogNTcuMjk1OCkgKiAxMCkvMTA7XG4gIGRlZ3JlZXMgPSAoZGVncmVlcyA8IDApID8gKDM2MCArIGRlZ3JlZXMpIDogZGVncmVlcztcbiAgdmFyIG1pbnV0ZWhhbmRtb3ZlbWVudCA9IChkZWdyZWVzLzAuNSAqIDYpICogKE1hdGguUEkvMTgwKTtcblxuICBtaW51dGVzID0gTWF0aC5mbG9vcigoZGVncmVlcy8wLjUpICUgNjApO1xuICBob3VycyA9IE1hdGguZmxvb3IoKGRlZ3JlZXMvMzApKTtcbiAgY29ycmVjdEhvdXIoKTtcblxuICBkeW5hbWljQ29udGV4dC5jbGVhclJlY3QoMCwgMCwgZHluYW1pY0NhbnZhcy53aWR0aCwgZHluYW1pY0NhbnZhcy5oZWlnaHQpO1xuICByb3RhdGVJbWFnZShtaW51dGVoYW5kbW92ZW1lbnQsIGltYWdlcy5taW51dGVIYW5kLnhQb3MgKyBpbWFnZXMubWludXRlSGFuZC53aWR0aCAvIDIsIGltYWdlcy5taW51dGVIYW5kLnlQb3MgKyBpbWFnZXMubWludXRlSGFuZC5oZWlnaHQsIGltYWdlcy5taW51dGVIYW5kKTtcbiAgcm90YXRlSW1hZ2UoYW5nbGUsIGltYWdlcy5ob3VySGFuZC54UG9zICsgaW1hZ2VzLmhvdXJIYW5kLndpZHRoIC8gMiwgaW1hZ2VzLmhvdXJIYW5kLnlQb3MgKyBpbWFnZXMuaG91ckhhbmQuaGVpZ2h0LCBpbWFnZXMuaG91ckhhbmQpO1xuICBkeW5hbWljQ29udGV4dC5maWxsVGV4dChwYWRJbnB1dChob3VycyksIGhvdXJIYW5keFBvcywgaG91ckhhbmR5UG9zKTtcbiAgZHluYW1pY0NvbnRleHQuZmlsbFRleHQocGFkSW5wdXQobWludXRlcyksIG1pbnV0ZUhhbmR4UG9zLCBtaW51dGVIYW5keVBvcyk7XG59XG5cbi8vUmVzZXQgdGhlIGhvdXJzIHN1Y2ggdGhhdCBpdCBpcyBhbHdheXMgYmV0d2VlbiAxIGFuZCAxMiBpbmNsdXNpdmVcbmZ1bmN0aW9uIGNvcnJlY3RIb3VyKClcbntcbiAgaG91cnMgPSBob3VycyAlIDEyO1xuICBpZihob3VycyA9PSAwKVxuICB7XG4gICAgaG91cnMgPSAxMjtcbiAgfVxuICBpZihob3VycyA8IDApXG4gIHtcbiAgICBob3VycyArPSAxMjtcbiAgfVxufVxuXG4vL0FkZCBhIDAgaW4gZnJvbnQgaWYgdGhlIG51bWJlciBoYXMgb25seSBvbmUgZGlnaXRcbmZ1bmN0aW9uIHBhZElucHV0KG51bWJlcikge1xuICByZXR1cm4gbnVtYmVyIDwgMTAgPyAoXCIwXCIgKyBudW1iZXIpIDogbnVtYmVyLnRvU3RyaW5nKCk7XG59XG5cbi8vUGVyZm9ybSB0aGUgcm90YXRpb24gb2YgdGhlIGNhbnZhcyBhbmQgZHJhd3MgdGhlIGltYWdlIG9uIHRoZSByb3RhdGVkIGFuZ2xlLlxuZnVuY3Rpb24gcm90YXRlSW1hZ2UoYW5nbGUsIHRyYW5zbGF0ZVhwb3MsIHRyYW5zbGF0ZVlwb3MsIGltYWdlT2JqKSB7XG4gIGR5bmFtaWNDb250ZXh0LnNhdmUoKTtcbiAgZHluYW1pY0NvbnRleHQudHJhbnNsYXRlKHRyYW5zbGF0ZVhwb3MsIHRyYW5zbGF0ZVlwb3MpO1xuICBkeW5hbWljQ29udGV4dC5yb3RhdGUoYW5nbGUpO1xuICBkeW5hbWljQ29udGV4dC50cmFuc2xhdGUoLSh0cmFuc2xhdGVYcG9zKSwgLSAodHJhbnNsYXRlWXBvcykpO1xuICBkeW5hbWljQ29udGV4dC5kcmF3SW1hZ2UoaW1hZ2VPYmouaW1hZ2UsIGltYWdlT2JqLnhQb3MsIGltYWdlT2JqLnlQb3MpO1xuICBkeW5hbWljQ29udGV4dC5yZXN0b3JlKCk7XG5cbn1cblxuaW1hZ2Vsb2FkT2JzZXJ2ZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoY2hlY2tJZmxvYWRlZCwgNDAwKTsiXX0=
